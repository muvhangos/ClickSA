<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live South African & Global News</title>
<style>
/* --- Base Styles --- */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: #f4f4f4;
  margin:0; padding:0; overflow-x:hidden;
}
header {
  background: linear-gradient(135deg,#1a73e8,#4285f4);
  color: #fff; padding: 20px;
  text-align:center; font-size:26px;
  display:flex; align-items:center; justify-content:center;
  gap:15px; flex-wrap:wrap;
  border-bottom-left-radius:12px; border-bottom-right-radius:12px;
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
}
header img {
  border-radius:50%; width:80px; height:80px;
  animation: spin 60s linear infinite;
  box-shadow:0 0 20px rgba(0,200,255,0.6);
  transition: box-shadow 0.6s;
}
#liveUpdate {
  font-weight:bold; color:#00cc66;
  font-size:1.2em; text-align:center; margin:15px 0;
}
.news-container {
  display:flex; flex-wrap:wrap; justify-content:center;
  gap:20px; padding:20px;
}
.news-card {
  background:#fff; width:300px; border-radius:12px;
  overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.1);
  display:flex; flex-direction:column;
  opacity:0; transform: translateY(20px);
  transition: transform 0.5s, opacity 0.5s, border 0.3s;
}
.news-card:hover {
  transform:translateY(-6px) scale(1.02);
  box-shadow:0 8px 16px rgba(0,0,0,0.2);
}
.news-card img {
  width:100%; height:180px; object-fit:cover;
  transition: transform 0.3s;
}
.news-card img:hover { transform: scale(1.05); }
.news-content { padding:15px; flex:1; display:flex; flex-direction:column; }
.news-title { font-size:18px; margin:0 0 10px; color:#222; font-weight:600; }
.news-desc { font-size:14px; color:#555; flex:1; margin-bottom:10px; line-height:1.4; }
.news-meta { font-size:12px; color:#888; margin-bottom:10px; }
.news-content a { text-decoration:none; color:#1a73e8; font-weight:bold; transition: color 0.3s; }
.news-content a:hover { color:#0b52c0; }
footer {
  text-align:center; padding:15px; background:#ddd;
  margin-top:20px; font-size:14px; color:#333;
  border-top-left-radius:12px; border-top-right-radius:12px;
}
.ticker-bar {
  position: fixed; bottom: 0; width: 100%; background: #1a73e8;
  color: #fff; display:flex; align-items:center; height:40px;
  overflow:hidden; font-weight:bold; box-shadow:0 -2px 8px rgba(0,0,0,0.2);
  z-index:999; transition: background 0.5s ease; font-size:14px;
}
.ticker-clock { flex:0 0 auto; padding:0 20px; border-right:2px solid rgba(255,255,255,0.3); }
.ticker-text { white-space:nowrap; flex:1; animation: scrollText 30s linear infinite; padding-left:20px; }
@keyframes scrollText { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
@keyframes fadeInUp { from { opacity:0; transform: translateY(20px); } to { opacity:1; transform: translateY(0); } }
@keyframes pulseGlow { 0% { box-shadow:0 0 15px #ffcc00; } 50% { box-shadow:0 0 30px #ffcc00; } 100% { box-shadow:0 0 15px #ffcc00; } }
@keyframes tickerPulse { 0% { background: #d32f2f; } 50% { background: #ff5252; } 100% { background: #d32f2f; } }
.highlight { border:3px solid #ffcc00; animation: pulseGlow 2s infinite; border-radius:12px; }
.ticker-bar.pulse { animation: tickerPulse 2s infinite; }
/* --- Responsive --- */
@media (max-width: 650px) { .news-card { width:90%; } header { font-size:22px; } }
</style>
</head>
<body>

<header>
üåç Live South African & Global News
<img id="earthLogo" src="https://upload.wikimedia.org/wikipedia/commons/9/97/The_Earth_seen_from_Apollo_17.jpg" alt="Earth Logo">
</header>

<p id="liveUpdate">üîÑ Live Updating...</p>

<div class="news-container" id="newsContainer"><p>Loading news...</p></div>

<footer>&copy; 2025 Live News Page</footer>

<div class="ticker-bar" id="tickerBar">
  <div class="ticker-clock" id="liveClock">üïí 00:00:00</div>
  <div class="ticker-text" id="breakingTicker">üîî Loading breaking headlines...</div>
</div>

<script>
// --- Detect user region ---
let userCountry = '';
fetch('https://ipapi.co/json/')
  .then(res=>res.json())
  .then(data=>{userCountry = data.country;})
  .catch(()=>{userCountry='';});

// --- RSS Feeds ---
const feeds = [
  { url:'https://feeds.bbci.co.uk/news/world/rss.xml', region:'Worldwide/UK' },
  { url:'https://rss.cnn.com/rss/edition_us.rss', region:'USA' },
  { url:'https://allafrica.com/tools/headlines/africa/headlines.xml', region:'Africa' },
  { url:'https://www.groundup.org.za/feed/', region:'South Africa' },
  { url:'https://www.news24.com/rss', region:'South Africa' },
  { url:'https://www.timeslive.co.za/rss/', region:'South Africa' },
  { url:'https://ewn.co.za/rss', region:'South Africa' }
];

const container = document.getElementById('newsContainer');
const liveText = document.getElementById('liveUpdate');
const earthLogo = document.getElementById('earthLogo');
const clockEl = document.getElementById('liveClock');
const tickerEl = document.getElementById('breakingTicker');
const tickerBar = document.getElementById('tickerBar');
let cache = JSON.parse(localStorage.getItem('cachedNews')) || { time:0, items:[] };

// --- Helpers ---
function animateLiveText(){const dots=['.','..','...',''];let i=0;setInterval(()=>{liveText.textContent=`üîÑ Live Updating${dots[i]}`;i=(i+1)%dots.length;},600);}
function glowEarth(active){earthLogo.style.boxShadow=active?'0 0 40px rgba(0,200,255,0.9),0 0 80px rgba(0,200,255,0.5)':'0 0 20px rgba(0,200,255,0.6)';}
function updateClock(){clockEl.textContent='üïí '+new Date().toLocaleTimeString('en-ZA',{hour12:false});}

// --- Render News ---
function renderNews(news){
  container.innerHTML='';
  let hasSANews = false;
  news.slice(0,25).forEach((article,index)=>{
    const card=document.createElement('div');
    card.className='news-card';
    card.style.animation=`fadeInUp 0.5s forwards`;
    card.style.animationDelay=`${index*0.1}s`;
    if(article.region==='South Africa' && userCountry==='ZA'){ card.classList.add('highlight'); hasSANews = true; }
    card.innerHTML=`
      <img src="${article.image||'https://via.placeholder.com/300x180?text=No+Image'}" alt="News Image">
      <div class="news-content">
        <div class="news-title">${article.title}</div>
        <div class="news-desc">${article.description.replace(/<[^>]+>/g,'').substring(0,120)}...</div>
        <div class="news-meta">${article.region}</div>
        <a href="${article.link}" target="_blank">Read More</a>
      </div>`;
    container.appendChild(card);
  });
  tickerEl.innerHTML=news.slice(0,10).map(n=>`üóûÔ∏è ${n.title}`).join('   ‚Ä¢   ');

  // Pulse ticker if SA news present for SA user
  if(hasSANews && userCountry==='ZA'){ tickerBar.classList.add('pulse'); }
  else { tickerBar.classList.remove('pulse'); }
}

// --- Fetch Feed ---
async function fetchFeed(feed){
  try{
    const resp = await fetch('https://api.rss2json.com/v1/api.json?rss_url='+encodeURIComponent(feed.url));
    const data = await resp.json();
    if(!data.items) return [];
    return data.items.map(item=>({title:item.title, description:item.description||'', link:item.link, image:(item.enclosure&&item.enclosure.link)||item.thumbnail||'', region:feed.region}));
  }catch{return[];}
}

// --- Load News ---
async function loadNews(){
  liveText.style.color='#00cc66'; liveText.textContent='üîÑ Updating news...'; glowEarth(true);
  if(Date.now()-cache.time<60000 && cache.items.length>0){ renderNews(cache.items); } else { container.innerHTML='<p>Loading latest news...</p>'; }
  const newsCollection=[];
  for(const feed of feeds){
    fetchFeed(feed).then(feedNews=>{
      newsCollection.push(...feedNews);
      const sa = newsCollection.filter(n=>n.region==='South Africa');
      const others = newsCollection.filter(n=>n.region!=='South Africa');
      const sorted = [...sa,...others].sort(()=>0.5-Math.random());
      renderNews(sorted);
      cache={time:Date.now(), items:sorted};
      localStorage.setItem('cachedNews', JSON.stringify(cache));
      tickerBar.classList.add('breaking');
      setTimeout(()=>{tickerBar.classList.remove('breaking'); glowEarth(false); liveText.style.color='#999'; liveText.textContent='‚úÖ News is Live'; }, 4000);
    });
  }
}

// --- Init ---
animateLiveText(); loadNews(); setInterval(loadNews,60000); setInterval(updateClock,1000);
</script>

</body>
</html>
